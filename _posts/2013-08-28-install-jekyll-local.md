---
layout: post
title: "安装使用本地jekyll"
description: ""
category: tools
tags: [jekyll, local]
---
{% include JB/setup %}

**jekyll** 

## install ##

1、[Building portable Jekyll for Windows](http://www.madhur.co.in/blog/2013/07/20/buildportablejekyll.html)
其中打的是x64的包，没法使用

2、设置系统 PATH，加上：

    %~dp0ruby\bin;%~dp0devkit\bin;%~dp0git\bin;%~dp0Python\App;

%~dp0为自己安装的jekyll目录。

3、自行下载[Ruby 2.0.0-p247](http://dl.bintray.com/oneclick/rubyinstaller/ruby-2.0.0-p247-i386-mingw32.7z?direct)

4、自行下载[DevKit-mingw64-32-4.7.2-20130224-1151-sfx.exe](http://rubyforge.org/frs/download.php/76805/DevKit-mingw64-32-4.7.2-20130224-1151-sfx.exe)

5、安装jekyll

    gem install jekyll -V

不带-V，则不显示消息。最好用马上有回显消息，出问题也比较清晰问题出在哪里，注意是命令后面加一个大写的V参数，表示详细日志的意思，这样就可以了。

安装出错，是因为devkit没初始化到位。都已被覆盖，因此需要重新设置。

6、下载解压devkit后，在devkit目录下Run the following commands

    ruby dk.rb init

to generate the config.yml file to be used later in this Step

7、 Edit the generated config.yml file to include installed Rubies. For example, in our case, it will look like this

    # This configuration file contains the absolute path locations of all
    # installed Rubies to be enhanced to work with the DevKit. This config
    # file is generated by the 'ruby dk.rb init' step and may be modified
    # before running the 'ruby dk.rb install' step. To include any installed
    # Rubies that were not automagically discovered, simply add a line below
    # the triple hyphens with the absolute path to the Ruby root directory.
    #
    # Example:
    #
    # ---
    # - C:/ruby19trunk
    # - C:/ruby192dev
    #
    ---
    - C:/ruby

8、 Run the following command to install to DevKit enhance your installed Rubies. This step installs (or updates) an operating_system.rb file into the relevant directory needed to implement a RubyGems

    ruby dk.rb install

9、 Install Jekyll using following command

    gem install jekyll

10、安装好后，运行jekyll serve，出错，提示`invalid byte sequence in GBK`，如：

    /home/ben/.rvm/gems/ruby-1.9.2-p290/gems/jekyll-0.11.0/lib/jekyll/convertible.rb:32:in `read_yaml': invalid byte sequence in US-ASCII (ArgumentError)

应该是jekyll的一个bug, fixed that with changing the line 29 in convertible.rb from

    self.content = File.read(File.join(base, name))

to

    self.content = File.read(File.join(base, name), :encoding => "utf-8")

11、以后就可以运行 `jekyll serve`了。

参考 [Running Jekyll on Windows](http://www.madhur.co.in/blog/2011/09/01/runningjekyllwindows.html)


2013-09-01: 在xp下，安装了jekyll后，到`ruby\lib\ruby\gems\2.0.0\gems\jekyll-1.1.2\test\source>`目录下，测试jekyll，发现：

    Generating... You are missing a library required for Textile. Please run:
    $ [sudo] gem install RedCloth

    Missing dependency: RedCloth

然后使用`gem install Redcloth`安装，安装时又发现：

    Parsing documentation for RedCloth-4.2.9-x86-mingw32
    unable to convert "\x90" from ASCII-8BIT to UTF-8 for lib/1.8/redcloth_scan.so, skipping
    unable to convert "\x90" from ASCII-8BIT to UTF-8 for lib/1.9/redcloth_scan.so, skipping

网上找[rdoc](https://github.com/rdoc/rdoc/commit/ceb81dd11911fb8a1f7342f5710f6afdd2036fc7)，说是rdoc的bug，`rdoc/rdoc.rb`中增加`return if RDoc::Parser.binary? filename`：

    343:     @stats.add_file filename
 
    +    return if RDoc::Parser.binary? filename

    345:     content = RDoc::Encoding.read_file filename, encoding
 
    347:     return unless content

终于能安装了，安装好后，运行jekyll，仍然报缺少RedCloth。再找，[Running Jekyll on Windows 7](http://stackoverflow.com/questions/7236269/running-jekyll-on-windows-7)，说明需要先运行`redcloth.bat`：

    After gem install RedCloth run redcloth.bat from \Ruby\bin (replace \Ruby\ with the Ruby installation dir).
    If it complains about not finding the path 1.9/redcloth_scan then do the following:
    Create a dir named 1.9 in \Ruby\lib\ruby\gems\1.9.1\gems\RedCloth-4.2.8\ext
    Copy everything from \Ruby\lib\ruby\gems\1.9.1\gems\RedCloth-4.2.8\ext\redcloth_scan in the 1.9 folder just created.

运行redcloth.bat，但是报的是少 2.0/redcloth_scan，尝试半天，最终发现 [RedCloth loaderror on ruby 2.0.0 [i386-mingw32]](http://stackoverflow.com/questions/17682753/redcloth-loaderror-on-ruby-2-0-0-i386-mingw32)：

    You might wanna stay with 1.9.3 for now, if you must use RedCloth.
    RedCloth doesn't seem to support 2.0.0 yet.

无解了。当前只使用markdown，不使用textile，因此暂无问题。

